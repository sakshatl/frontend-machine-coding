<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grid Lights</title>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    .grid-container {
      display: grid;
      grid-template-columns: repeat(3, 100px);
      gap: 16px;
    }

    .cell {
      height: 100px;
      width: 100px;
      border: 1px solid black;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .activated {
      background: green;
    }

  </style>

</head>
<body>
  <div class="grid-container" id="grid-container">

  </div>

  <script>
    const gridContainerElement = document.getElementById('grid-container');
    const activatedCells = [];

    function checkForDeactivateion() {
      const isAllActivated = activatedCells.length === 9;
      if(isAllActivated) {
        let intervalId;
        intervalId = setInterval(() => {
          const cell = activatedCells.pop();
          cell.classList.remove('activated');
          if(!activatedCells.length) {
            clearInterval(intervalId);
          }
        }, 300);
      }
    }

    function handleActivateCell(e) {
      const cell = e.target;
      cell.classList.add('activated');
      activatedCells.push(cell);
      
      // Check for de-activation on every click
      checkForDeactivateion();
    }

    function renderGridsUI() {
      for (let i = 0; i < 9; i++) {
        const div = document.createElement('div');
        div.classList.add('cell');
        div.innerHTML = i + 1
        div.addEventListener('click', handleActivateCell, { once: true });
        gridContainerElement.appendChild(div)
      }
    }

    renderGridsUI();

  </script>
</body>
</html>